{% extends 'base.html' %}

{% block content %}
<div class="team-availability-page">
    <!-- Hero Section -->
    <div class="hero-section">
        <div class="hero-background">
            <div class="hero-particle"></div>
            <div class="hero-particle"></div>
            <div class="hero-particle"></div>
        </div>
        <div class="container">
            <div class="hero-content text-center" data-aos="fade-up">
                <div class="hero-icon">
                    <i class="fas fa-users-clock"></i>
                    <div class="icon-rings">
                        <div class="ring ring-1"></div>
                        <div class="ring ring-2"></div>
                    </div>
                </div>
                <h1 class="hero-title">24 Saat Takım Ortak Çalışma Takvimi</h1>
                <p class="hero-subtitle">Takım arkadaşlarınızın günün her saatindeki müsaitlik durumunu görüntüleyin</p>
                
                <!-- Breadcrumb -->
                <nav class="hero-breadcrumb" aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item">
                            <a href="{% url 'home_page' %}">
                                <i class="fas fa-home me-1"></i>Ana Sayfa
                            </a>
                        </li>
                        <li class="breadcrumb-item active">Takım Ortak Çalışma Saati</li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <div class="team-availability-container">
            <!-- Common Projects Section -->
            <div class="common-projects-section" data-aos="fade-up" data-aos-delay="100">
                <div class="projects-showcase-card">
                    <div class="showcase-header">
                        <div class="header-icon-modern">
                            <i class="fas fa-handshake"></i>
                        </div>
                        <div class="header-content-modern">
                            <h3>Ortak Projeleriniz</h3>
                            <p>{{ assigned_projects.count }} proje üzerinde birlikte çalışıyoruz</p>
                        </div>
                        <div class="header-stats">
                            <div class="stat-badge">
                                <span class="stat-number">{{ total_teammates }}</span>
                                <span class="stat-label">Takım Arkadaşı</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="projects-showcase-grid">
                        {% for project in assigned_projects %}
                        <div class="project-showcase-item" data-aos="zoom-in" data-aos-delay="{% cycle '150' '200' '250' %}">
                            <div class="project-visual">
                                <div class="project-icon-large">
                                    <i class="fas {% if 'lastik' in project.name|lower or 'tyre' in project.name|lower %}fa-cog{% elif 'track' in project.name|lower %}fa-chart-line{% elif 'opti' in project.name|lower %}fa-eye{% elif 'law' in project.name|lower %}fa-balance-scale{% elif 'voc' in project.name|lower %}fa-microphone{% else %}fa-code{% endif %}"></i>
                                </div>
                                <div class="project-glow"></div>
                            </div>
                            <div class="project-info-modern">
                                <h4>{{ project.name }}</h4>
                                <p>{{ project.short_description|truncatewords:12 }}</p>
                                <div class="project-features-modern">
                                    <span class="feature-tag">{{ project.get_team_size_display }}</span>
                                    <span class="feature-tag">{{ project.get_work_type_display }}</span>
                                    <span class="feature-tag">{{ project.get_duration_display }}</span>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

            {% if teammates_with_availability > 0 %}
                <!-- Team Calendar -->
                <div class="calendar-section-modern" data-aos="fade-up" data-aos-delay="200">
                    <div class="calendar-header-modern">
                        <div class="calendar-title-section">
                            <h3>24 Saat Haftalık Takım Ortak Çalışma Takvimi</h3>
                            <p>Her hücre o saatte müsait olan takım arkadaşlarınızı gösterir</p>
                        </div>
                        <div class="calendar-controls">
                            <div class="view-toggle">
                                <button class="toggle-btn active" data-view="compact">
                                    <i class="fas fa-th"></i>
                                    <span>Kompakt</span>
                                </button>
                                <button class="toggle-btn" data-view="detailed">
                                    <i class="fas fa-list"></i>
                                    <span>Detaylı</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="calendar-container-modern">
                        <div class="table-responsive-modern">
                            <table class="table table-bordered team-calendar-modern compact-view" id="teamCalendar">
                                <thead class="sticky-header-modern">
                                    <tr>
                                        <th class="time-header-modern sticky-column-modern">
                                            <div class="header-content">
                                                <i class="fas fa-clock"></i>
                                                <span>Saat</span>
                                            </div>
                                        </th>
                                        {% for day_data in calendar_grid %}
                                        <th class="day-header-modern">
                                            <div class="day-header-content">
                                                <div class="day-name">{{ day_data.day_name }}</div>
                                                <div class="day-summary">
                                                    {% with day_total=0 %}
                                                        {% for slot_data in day_data.time_slots %}
                                                            {% if slot_data.available_count > 0 %}
                                                                {% with day_total=day_total|add:slot_data.available_count %}
                                                                {% endwith %}
                                                            {% endif %}
                                                        {% endfor %}
                                                        <span class="day-activity-count">{{ day_total }} aktivite</span>
                                                    {% endwith %}
                                                </div>
                                            </div>
                                        </th>
                                        {% endfor %}
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for time_slot in time_slots %}
                                    <tr class="time-row-modern" data-time="{{ time_slot }}" 
                                        data-period="{% if time_slot|slice:':2' < '06' %}night{% elif time_slot|slice:':2' < '12' %}morning{% elif time_slot|slice:':2' < '18' %}afternoon{% else %}evening{% endif %}">
                                        <td class="time-cell-modern sticky-column-modern">
                                            <div class="time-display-modern">
                                                <div class="time-main">{{ time_slot|slice:':5' }}</div>
                                                <div class="time-period-indicator {% if time_slot|slice:':2' < '06' %}night{% elif time_slot|slice:':2' < '12' %}morning{% elif time_slot|slice:':2' < '18' %}afternoon{% else %}evening{% endif %}"></div>
                                            </div>
                                        </td>
                                        {% for day_data in calendar_grid %}
                                            {% for slot_data in day_data.time_slots %}
                                                {% if slot_data.time == time_slot %}
                                                <td class="availability-cell-modern {% if slot_data.available_count > 0 %}has-availability{% endif %} {% if slot_data.available_count == 1 %}single-user{% elif slot_data.available_count <= 3 %}few-users{% else %}many-users{% endif %}{% if slot_data.is_self_available %} is-self{% endif %}"
                                                    data-day="{{ day_data.day_code }}" 
                                                    data-time="{{ time_slot }}"
                                                    data-count="{{ slot_data.available_count }}"
                                                    data-self-available="{{ slot_data.is_self_available }}"
                                                    title="{% if slot_data.is_self_available %}SİZ bu saatte müsaitsiniz{% if slot_data.available_teammates %} - Ayrıca {{ slot_data.available_count }} takım arkadaşınız: {{ slot_data.available_teammates|join:', ' }}{% endif %}{% elif slot_data.available_teammates %}{{ slot_data.available_count }} kişi müsait: {{ slot_data.available_teammates|join:', ' }}{% else %}Kimse müsait değil{% endif %}">
                                                    {% if slot_data.available_teammates %}
                                                        <div class="cell-content">
                                                            <div class="availability-indicator">
                                                                <div class="user-count">{{ slot_data.available_count }}</div>
                                                                <div class="availability-dots">
                                                                    {% for teammate in slot_data.available_teammates|slice:":3" %}
                                                                    <div class="user-dot" title="{{ teammate }}"></div>
                                                                    {% endfor %}
                                                                    {% if slot_data.available_count > 3 %}
                                                                    <div class="user-dot overflow" title="+{{ slot_data.available_count|add:'-3' }} kişi daha">+</div>
                                                                    {% endif %}
                                                                </div>
                                                            </div>
                                                            <div class="teammate-list-hover">
                                                                {% for teammate in slot_data.available_teammates %}
                                                                <div class="teammate-item">{{ teammate }}</div>
                                                                {% endfor %}
                                                            </div>
                                                        </div>
                                                    {% else %}
                                                        <div class="cell-content empty">
                                                            <div class="empty-indicator">-</div>
                                                        </div>
                                                    {% endif %}
                                                </td>
                                                {% endif %}
                                            {% endfor %}
                                        {% endfor %}
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Enhanced Calendar Legend -->
                    <div class="calendar-legend-modern">
                        <h4>Takvim Rehberi</h4>
                        <div class="legend-grid">
                            <div class="legend-item-modern">
                                <div class="legend-visual empty"></div>
                                <span>Müsait kimse yok</span>
                            </div>
                            <div class="legend-item-modern">
                                <div class="legend-visual single-user"></div>
                                <span>1 kişi müsait</span>
                            </div>
                            <div class="legend-item-modern">
                                <div class="legend-visual few-users"></div>
                                <span>2-3 kişi müsait</span>
                            </div>
                            <div class="legend-item-modern">
                                <div class="legend-visual many-users"></div>
                                <span>4+ kişi müsait</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Teammates List -->
                <div class="teammates-section" data-aos="fade-up" data-aos-delay="300">
                    <div class="teammates-header">
                        <h3>Takım Arkadaşlarınız</h3>
                        <p>Aynı projelerde çalıştığınız stajyer arkadaşlarınız ve ortak projeleriniz</p>
                    </div>
                    <div class="teammates-grid">
                        {% for teammate_data in teammates_with_projects %}
                        <div class="teammate-card">
                            <div class="teammate-avatar">
                                <i class="fas fa-user-graduate"></i>
                            </div>
                            <div class="teammate-info">
                                <h4>{{ teammate_data.intern.get_full_name }}</h4>
                                <div class="teammate-status">
                                    {% if teammate_data.has_availability %}
                                        <span class="status-badge available">
                                            <i class="fas fa-check-circle"></i>
                                            Müsaitlik Belirtti
                                        </span>
                                        <div class="availability-summary">
                                            {{ teammate_data.availability_data.get_total_hours }} saat/hafta
                                        </div>
                                    {% else %}
                                        <span class="status-badge unavailable">
                                            <i class="fas fa-clock"></i>
                                            Henüz Belirtmedi
                                        </span>
                                    {% endif %}
                                </div>
                                
                                <div class="teammate-projects">
                                    <div class="projects-header">
                                        <i class="fas fa-handshake"></i>
                                        <span>Ortak Projeler:</span>
                                    </div>
                                    <div class="projects-badges">
                                        {% for project in teammate_data.common_projects %}
                                            <span class="badge bg-primary common-project" 
                                                  title="Ortak Proje: {{ project.name }}">
                                                <i class="fas fa-star"></i>
                                                {{ project.name }}
                                            </span>
                                        {% empty %}
                                            <span class="badge bg-light text-muted no-projects">
                                                <i class="fas fa-info-circle"></i>
                                                Ortak proje bulunamadı
                                            </span>
                                        {% endfor %}
                                    </div>
                                    
                                    {% if teammate_data.common_projects %}
                                    <div class="project-stats">
                                        <span class="stat-item common-stat">
                                            <i class="fas fa-handshake"></i>
                                            {{ teammate_data.common_projects_count }} ortak proje
                                        </span>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            {% else %}
                <!-- No Availability Data -->
                <div class="no-data-section" data-aos="fade-up" data-aos-delay="200">
                    <div class="no-data-card">
                        <div class="no-data-icon">
                            <i class="fas fa-calendar-times"></i>
                        </div>
                        <div class="no-data-content">
                            <h3>Henüz Müsaitlik Verisi Yok</h3>
                            <p>Takım arkadaşlarınızın henüz hiçbiri müsaitlik durumunu belirtmemiş. Takvim görüntülemek için takım üyelerinin ortak çalışma saatlerini belirtmesi gerekiyor.</p>
                        </div>
                    </div>
                </div>
            {% endif %}

            <!-- Action Buttons -->
            <div class="action-section" data-aos="fade-up" data-aos-delay="400">
                <div class="action-buttons">
                    <a href="{% url 'select_availability' %}" class="btn btn-primary">
                        <div class="btn-content">
                            <i class="fas fa-calendar-plus"></i>
                            <span>Kendi Müsaitliğimi Düzenle</span>
                        </div>
                    </a>
                    
                    <a href="{% url 'view_availability' %}" class="btn btn-secondary">
                        <div class="btn-content">
                            <i class="fas fa-eye"></i>
                            <span>Kendi Müsaitliğimi Görüntüle</span>
                        </div>
                    </a>
                    
                    <a href="{% url 'home_page' %}" class="btn btn-outline">
                        <div class="btn-content">
                            <i class="fas fa-home"></i>
                            <span>Ana Sayfaya Dön</span>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    :root {
        --primary-color: #3b82f6;
        --secondary-color: #10b981;
        --success-color: #059669;
        --warning-color: #f59e0b;
        --error-color: #ef4444;
        --night-color: #1e1b4b;
        --morning-color: #fbbf24;
        --afternoon-color: #60a5fa;
        --evening-color: #f97316;
        --text-color: #1f2937;
        --text-light: #6b7280;
        --bg-light: #f8fafc;
        --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        --card-shadow-hover: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }

    .team-availability-page {
        min-height: 100vh;
        background: linear-gradient(135deg, var(--bg-light) 0%, #ffffff 100%);
    }

    /* Hero Section */
    .hero-section {
        position: relative;
        padding: 4rem 0 2rem;
        background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
        color: white;
        overflow: hidden;
    }

    .hero-background {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 1;
    }

    .hero-particle {
        position: absolute;
        width: 200px;
        height: 200px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.1);
        animation: float 6s ease-in-out infinite;
    }

    .hero-particle:nth-child(1) {
        top: 10%;
        left: 10%;
        animation-delay: 0s;
    }

    .hero-particle:nth-child(2) {
        top: 60%;
        right: 15%;
        animation-delay: 2s;
    }

    .hero-particle:nth-child(3) {
        bottom: 20%;
        left: 60%;
        animation-delay: 4s;
    }

    @keyframes float {
        0%, 100% { transform: translateY(0px) rotate(0deg); }
        50% { transform: translateY(-20px) rotate(180deg); }
    }

    .hero-content {
        position: relative;
        z-index: 2;
    }

    .hero-icon {
        position: relative;
        display: inline-block;
        margin-bottom: 2rem;
    }

    .hero-icon i {
        font-size: 4rem;
        color: white;
        position: relative;
        z-index: 2;
    }

    .icon-rings {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }

    .ring {
        position: absolute;
        width: 80px;
        height: 80px;
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        animation: pulse-ring 2s ease-in-out infinite;
    }

    .ring:nth-child(1) { animation-delay: 0s; }
    .ring:nth-child(2) { animation-delay: 1s; }

    @keyframes pulse-ring {
        0% { transform: translate(-50%, -50%) scale(0.8); opacity: 1; }
        100% { transform: translate(-50%, -50%) scale(2); opacity: 0; }
    }

    .hero-title {
        font-size: 3rem;
        font-weight: 700;
        margin-bottom: 1rem;
    }

    .hero-subtitle {
        font-size: 1.25rem;
        opacity: 0.9;
        margin-bottom: 2rem;
    }

    .hero-breadcrumb {
        display: inline-block;
        background: rgba(255, 255, 255, 0.1);
        padding: 0.75rem 1.5rem;
        border-radius: 50px;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .breadcrumb {
        background: none;
        padding: 0;
        margin: 0;
        font-size: 0.9rem;
    }

    .breadcrumb-item a {
        color: rgba(255, 255, 255, 0.9);
        text-decoration: none;
        font-weight: 500;
    }

    .breadcrumb-item.active {
        color: rgba(255, 255, 255, 0.7);
    }

    .breadcrumb-item + .breadcrumb-item::before {
        content: "›";
        color: rgba(255, 255, 255, 0.6);
        padding: 0 0.5rem;
    }

    /* Main Container */
    .team-availability-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 3rem 1rem;
    }

    /* Common Projects Section */
    .common-projects-section {
        margin-bottom: 4rem;
    }

    .projects-showcase-card {
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.05), rgba(16, 185, 129, 0.05));
        border: 2px solid rgba(59, 130, 246, 0.1);
        border-radius: 24px;
        padding: 2rem;
        box-shadow: var(--card-shadow-hover);
    }

    .showcase-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 2rem;
        flex-wrap: wrap;
        gap: 1rem;
    }

    .header-icon-modern {
        width: 80px;
        height: 80px;
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        border-radius: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 2rem;
        box-shadow: 0 10px 30px rgba(59, 130, 246, 0.3);
    }

    .header-content-modern h3 {
        font-size: 2rem;
        font-weight: 700;
        color: var(--text-color);
        margin-bottom: 0.5rem;
    }

    .header-content-modern p {
        color: var(--text-light);
        font-size: 1.1rem;
        margin: 0;
    }

    .header-stats {
        display: flex;
        gap: 1rem;
    }

    .stat-badge {
        background: white;
        padding: 1rem 1.5rem;
        border-radius: 16px;
        text-align: center;
        box-shadow: var(--card-shadow);
        border: 2px solid rgba(59, 130, 246, 0.1);
    }

    .stat-number {
        display: block;
        font-size: 2rem;
        font-weight: 800;
        color: var(--primary-color);
        line-height: 1;
    }

    .stat-label {
        font-size: 0.9rem;
        color: var(--text-light);
        font-weight: 500;
    }

    .projects-showcase-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 2rem;
    }

    .project-showcase-item {
        background: white;
        border-radius: 20px;
        padding: 2rem;
        box-shadow: var(--card-shadow);
        border: 2px solid transparent;
        transition: all 0.4s ease;
        position: relative;
        overflow: hidden;
    }

    .project-showcase-item:hover {
        transform: translateY(-8px);
        box-shadow: var(--card-shadow-hover);
        border-color: var(--primary-color);
    }

    .project-visual {
        position: relative;
        display: flex;
        justify-content: center;
        margin-bottom: 1.5rem;
    }

    .project-icon-large {
        width: 80px;
        height: 80px;
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        border-radius: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 2rem;
        position: relative;
        z-index: 2;
        transition: all 0.3s ease;
    }

    .project-showcase-item:hover .project-icon-large {
        transform: scale(1.1) rotateY(180deg);
    }

    .project-glow {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 100px;
        height: 100px;
        background: radial-gradient(circle, rgba(59, 130, 246, 0.3), transparent);
        border-radius: 50%;
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .project-showcase-item:hover .project-glow {
        opacity: 1;
    }

    .project-info-modern h4 {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--text-color);
        margin-bottom: 0.75rem;
        text-align: center;
    }

    .project-info-modern p {
        color: var(--text-light);
        line-height: 1.6;
        text-align: center;
        margin-bottom: 1.5rem;
    }

    .project-features-modern {
        display: flex;
        justify-content: center;
        gap: 0.5rem;
        flex-wrap: wrap;
    }

    .feature-tag {
        background: rgba(59, 130, 246, 0.1);
        color: var(--primary-color);
        padding: 0.4rem 0.8rem;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
        border: 1px solid rgba(59, 130, 246, 0.2);
    }

    /* Calendar Section */
    .calendar-section-modern {
        margin-bottom: 4rem;
    }

    .calendar-header-modern {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        flex-wrap: wrap;
        gap: 1rem;
    }

    .calendar-title-section h3 {
        font-size: 2rem;
        font-weight: 700;
        color: var(--text-color);
        margin-bottom: 0.5rem;
    }

    .calendar-title-section p {
        color: var(--text-light);
        font-size: 1.1rem;
        margin: 0;
    }

    .calendar-controls {
        display: flex;
        gap: 1rem;
    }

    .view-toggle {
        display: flex;
        background: #f1f5f9;
        border-radius: 12px;
        padding: 0.25rem;
    }

    .toggle-btn {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1rem;
        border: none;
        background: transparent;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.9rem;
        font-weight: 500;
        color: var(--text-light);
    }

    .toggle-btn.active {
        background: white;
        color: var(--primary-color);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .calendar-container-modern {
        background: white;
        border-radius: 20px;
        box-shadow: var(--card-shadow-hover);
        overflow: hidden;
        border: 2px solid rgba(59, 130, 246, 0.1);
    }

    .table-responsive-modern {
        max-height: 70vh;
        overflow: auto;
        border-radius: 20px;
    }

    .team-calendar-modern {
        margin: 0;
        font-size: 0.85rem;
        width: 100%;
        min-width: 900px;
        border-collapse: separate;
        border-spacing: 0;
    }

    /* Compact View Styles */
    .team-calendar-modern.compact-view .availability-cell-modern {
        padding: 0.5rem 0.25rem;
        min-height: 60px;
    }

    .team-calendar-modern.compact-view .user-count {
        font-size: 1rem;
        width: 25px;
        height: 25px;
    }

    .team-calendar-modern.compact-view .availability-dots {
        display: none;
    }

    .team-calendar-modern.compact-view .cell-content {
        gap: 0.25rem;
    }

    /* Detailed View Styles */
    .team-calendar-modern.detailed-view .availability-cell-modern {
        padding: 1rem 0.75rem;
        min-height: 100px;
    }

    .team-calendar-modern.detailed-view .user-count {
        font-size: 1.5rem;
        width: 35px;
        height: 35px;
    }

    .team-calendar-modern.detailed-view .availability-dots {
        gap: 0.5rem;
    }

    .team-calendar-modern.detailed-view .user-dot {
        width: 10px;
        height: 10px;
    }

    .team-calendar-modern.detailed-view .cell-content {
        gap: 0.75rem;
    }

    .sticky-header-modern {
        position: sticky;
        top: 0;
        z-index: 100;
    }

    .sticky-column-modern {
        position: sticky;
        left: 0;
        z-index: 50;
        background: white;
    }

    .team-calendar-modern th {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        color: white;
        font-weight: 600;
        text-align: center;
        padding: 1.5rem 1rem;
        border: none;
        white-space: nowrap;
        position: relative;
    }

    .time-header-modern {
        width: 140px;
        background: linear-gradient(135deg, #4b5563, #374151) !important;
    }

    .header-content {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
    }

    .day-header-modern {
        min-width: 180px;
    }

    .day-header-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.5rem;
    }

    .day-name {
        font-size: 1.1rem;
        font-weight: 700;
    }

    .day-activity-count {
        font-size: 0.8rem;
        opacity: 0.9;
        background: rgba(255, 255, 255, 0.2);
        padding: 0.25rem 0.75rem;
        border-radius: 12px;
    }

    .time-cell-modern {
        background: linear-gradient(135deg, #f8fafc, #f1f5f9);
        font-weight: 600;
        text-align: center;
        vertical-align: middle;
        width: 140px;
        border-right: 3px solid #e5e7eb;
        padding: 1rem 0.5rem;
        border-bottom: 1px solid #e5e7eb;
    }

    .time-display-modern {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.5rem;
    }

    .time-main {
        font-size: 1.1rem;
        font-weight: 700;
        color: var(--text-color);
    }

    .time-period-indicator {
        width: 30px;
        height: 4px;
        border-radius: 2px;
    }

    .time-period-indicator.night {
        background: var(--night-color);
    }

    .time-period-indicator.morning {
        background: var(--morning-color);
    }

    .time-period-indicator.afternoon {
        background: var(--afternoon-color);
    }

    .time-period-indicator.evening {
        background: var(--evening-color);
    }

    .availability-cell-modern {
        padding: 0.75rem 0.5rem;
        vertical-align: middle;
        min-height: 80px;
        position: relative;
        background: #fafafa;
        transition: all 0.3s ease;
        border: 1px solid #e5e7eb;
        border-bottom: 1px solid #e5e7eb;
    }

    .availability-cell-modern:hover {
        background: rgba(59, 130, 246, 0.1);
        transform: scale(1.02);
        z-index: 10;
        border-color: var(--primary-color);
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
    }

    .cell-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.5rem;
        position: relative;
    }

    .availability-indicator {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.5rem;
    }

    .user-count {
        font-size: 1.2rem;
        font-weight: 700;
        color: var(--primary-color);
        background: rgba(59, 130, 246, 0.1);
        width: 30px;
        height: 30px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 2px solid var(--primary-color);
    }

    .availability-dots {
        display: flex;
        gap: 0.25rem;
        flex-wrap: wrap;
        justify-content: center;
    }

    .user-dot {
        width: 8px;
        height: 8px;
        background: var(--primary-color);
        border-radius: 50%;
        transition: all 0.2s ease;
    }

    .user-dot.overflow {
        background: var(--warning-color);
        width: 16px;
        height: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.6rem;
        font-weight: 700;
        color: white;
    }

    .teammate-list-hover {
        position: absolute;
        top: 100%;
        left: 50%;
        transform: translateX(-50%);
        background: white;
        border: 2px solid var(--primary-color);
        border-radius: 8px;
        padding: 0.5rem;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
        z-index: 20;
        min-width: 150px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    }

    .availability-cell-modern:hover .teammate-list-hover {
        opacity: 1;
        visibility: visible;
    }

    .teammate-item {
        font-size: 0.8rem;
        font-weight: 500;
        color: var(--text-color);
        padding: 0.25rem;
        text-align: center;
        border-bottom: 1px solid #e5e7eb;
    }

    .teammate-item:last-child {
        border-bottom: none;
    }

    .empty-indicator {
        color: var(--text-light);
        font-style: italic;
        font-size: 1.2rem;
        opacity: 0.5;
    }

    /* Color coding for different availability levels */
    .availability-cell-modern.single-user {
        background: rgba(34, 197, 94, 0.05);
        border-left: 4px solid #22c55e;
    }

    .availability-cell-modern.single-user .user-count {
        color: #22c55e;
        background: rgba(34, 197, 94, 0.1);
        border-color: #22c55e;
    }

    .availability-cell-modern.single-user .user-dot {
        background: #22c55e;
    }

    .availability-cell-modern.few-users {
        background: rgba(59, 130, 246, 0.05);
        border-left: 4px solid var(--primary-color);
    }

    .availability-cell-modern.many-users {
        background: rgba(245, 158, 11, 0.05);
        border-left: 4px solid var(--warning-color);
    }

    .availability-cell-modern.many-users .user-count {
        color: var(--warning-color);
        background: rgba(245, 158, 11, 0.1);
        border-color: var(--warning-color);
    }

    .availability-cell-modern.many-users .user-dot {
        background: var(--warning-color);
    }

    /* Enhanced Calendar Legend */
    .calendar-legend-modern {
        background: linear-gradient(135deg, #f8fafc, #f1f5f9);
        padding: 2rem;
        border-top: 1px solid #e5e7eb;
        border-radius: 0 0 20px 20px;
    }

    .calendar-legend-modern h4 {
        font-size: 1.3rem;
        font-weight: 600;
        color: var(--text-color);
        margin-bottom: 1.5rem;
        text-align: center;
    }

    .legend-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
    }

    .legend-item-modern {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1rem;
        background: white;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        border: 1px solid #e5e7eb;
    }

    .legend-visual {
        width: 40px;
        height: 40px;
        border-radius: 8px;
        border: 2px solid #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 0.9rem;
    }

    .legend-visual.empty {
        background: #fafafa;
        color: var(--text-light);
    }

    .legend-visual.empty::after {
        content: "-";
    }

    .legend-visual.single-user {
        background: rgba(34, 197, 94, 0.1);
        border-color: #22c55e;
        color: #22c55e;
    }

    .legend-visual.single-user::after {
        content: "1";
    }

    .legend-visual.few-users {
        background: rgba(59, 130, 246, 0.1);
        border-color: var(--primary-color);
        color: var(--primary-color);
    }

    .legend-visual.few-users::after {
        content: "2-3";
    }

    .legend-visual.many-users {
        background: rgba(245, 158, 11, 0.1);
        border-color: var(--warning-color);
        color: var(--warning-color);
    }

    .legend-visual.many-users::after {
        content: "4+";
    }

    /* Teammates Section */
    .teammates-section {
        margin-bottom: 3rem;
    }

    .teammates-header {
        text-align: center;
        margin-bottom: 2rem;
    }

    .teammates-header h3 {
        font-size: 2rem;
        font-weight: 700;
        color: var(--text-color);
        margin-bottom: 0.5rem;
    }

    .teammates-header p {
        color: var(--text-light);
        font-size: 1.1rem;
    }

    .teammates-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;
    }

    .teammate-card {
        background: white;
        border-radius: 16px;
        padding: 1.5rem;
        box-shadow: var(--card-shadow);
        display: flex;
        align-items: flex-start;
        gap: 1rem;
        transition: all 0.3s ease;
        border: 1px solid #e5e7eb;
    }

    .teammate-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--card-shadow-hover);
        border-color: var(--primary-color);
    }

    .teammate-avatar {
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.5rem;
        flex-shrink: 0;
    }

    .teammate-info {
        flex: 1;
    }

    .teammate-info h4 {
        font-size: 1.15rem;
        font-weight: 700;
        color: var(--text-color);
        margin-bottom: 0.5rem;
    }

    .teammate-status {
        margin-bottom: 1rem;
    }

    .status-badge {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.25rem 0.75rem;
        border-radius: 15px;
        font-size: 0.8rem;
        font-weight: 500;
        margin-bottom: 0.25rem;
    }

    .status-badge.available {
        background: rgba(5, 150, 105, 0.1);
        color: var(--success-color);
        border: 1px solid rgba(5, 150, 105, 0.2);
    }

    .status-badge.unavailable {
        background: rgba(107, 114, 128, 0.1);
        color: var(--text-light);
        border: 1px solid rgba(107, 114, 128, 0.2);
    }

    .availability-summary {
        font-size: 0.8rem;
        color: var(--text-light);
        font-style: italic;
    }

    .teammate-projects {
        margin-top: 1rem;
        padding-top: 1rem;
        border-top: 1px solid #e5e7eb;
    }

    .projects-header {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-bottom: 0.75rem;
        font-size: 0.9rem;
        font-weight: 600;
        color: var(--text-color);
    }

    .projects-header i {
        color: var(--primary-color);
        font-size: 0.85rem;
    }

    .projects-badges {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-bottom: 0.75rem;
    }

    .projects-badges .badge {
        display: inline-flex;
        align-items: center;
        gap: 0.25rem;
        padding: 0.4rem 0.8rem;
        font-size: 0.75rem;
        font-weight: 500;
        border-radius: 15px;
        transition: all 0.3s ease;
        border: 1px solid transparent;
    }

    .common-project {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)) !important;
        color: white !important;
        border: 1px solid rgba(59, 130, 246, 0.3) !important;
        box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
        font-weight: 600;
    }

    .common-project:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
    }

    .no-projects {
        background: rgba(107, 114, 128, 0.1) !important;
        color: var(--text-light) !important;
        border: 1px solid rgba(107, 114, 128, 0.2) !important;
    }

    .project-stats {
        display: flex;
        gap: 1rem;
        margin-top: 0.5rem;
    }

    .stat-item {
        display: flex;
        align-items: center;
        gap: 0.25rem;
        font-size: 0.8rem;
        color: var(--text-light);
        font-weight: 500;
    }

    .common-stat {
        color: var(--primary-color);
        font-weight: 600;
    }

    .common-stat i {
        color: var(--primary-color);
    }

    /* No Data Section */
    .no-data-section {
        margin: 4rem 0;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .no-data-card {
        background: white;
        border-radius: 20px;
        padding: 4rem 3rem;
        text-align: center;
        box-shadow: var(--card-shadow);
        border: 2px solid rgba(107, 114, 128, 0.1);
        max-width: 600px;
        width: 100%;
    }

    .no-data-icon {
        margin-bottom: 2rem;
    }

    .no-data-icon i {
        font-size: 4rem;
        color: var(--text-light);
        opacity: 0.6;
    }

    .no-data-content h3 {
        font-size: 1.8rem;
        font-weight: 700;
        color: var(--text-color);
        margin-bottom: 1rem;
    }

    .no-data-content p {
        color: var(--text-light);
        font-size: 1.1rem;
        line-height: 1.6;
        margin: 0;
    }

    /* Action Section */
    .action-section {
        margin-top: 4rem;
        padding: 3rem 0;
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.05), rgba(16, 185, 129, 0.05));
        border-radius: 20px;
        text-align: center;
    }

    .action-buttons {
        display: flex;
        justify-content: center;
        gap: 1.5rem;
        flex-wrap: wrap;
    }

    .action-buttons .btn {
        display: inline-flex;
        align-items: center;
        text-decoration: none;
        padding: 1rem 2rem;
        border-radius: 16px;
        font-weight: 600;
        font-size: 1rem;
        transition: all 0.3s ease;
        border: 2px solid transparent;
        min-width: 220px;
        justify-content: center;
    }

    .btn-content {
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }

    .btn-content i {
        font-size: 1.1rem;
    }

    .btn-primary {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        color: white;
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
    }

    .btn-primary:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);
        color: white;
        text-decoration: none;
    }

    .btn-secondary {
        background: white;
        color: var(--primary-color);
        border-color: var(--primary-color);
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.1);
    }

    .btn-secondary:hover {
        background: var(--primary-color);
        color: white;
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);
        text-decoration: none;
    }

    .btn-outline {
        background: transparent;
        color: var(--text-color);
        border-color: #e5e7eb;
    }

    .btn-outline:hover {
        background: var(--text-color);
        color: white;
        border-color: var(--text-color);
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(31, 41, 55, 0.2);
        text-decoration: none;
    }

    /* Responsive Design */
    @media (max-width: 1200px) {
        .showcase-header {
            flex-direction: column;
            text-align: center;
        }

        .calendar-header-modern {
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
    }

    @media (max-width: 768px) {
        .hero-title {
            font-size: 2rem;
        }

        .hero-subtitle {
            font-size: 1rem;
        }

        .team-availability-container {
            padding: 2rem 1rem;
        }

        .projects-showcase-grid {
            grid-template-columns: 1fr;
        }

        .teammates-grid {
            grid-template-columns: 1fr;
        }

        .action-buttons {
            flex-direction: column;
            align-items: center;
        }

        .action-buttons .btn {
            min-width: 280px;
        }

        .table-responsive-modern {
            max-height: 50vh;
        }

        .team-calendar-modern {
            font-size: 0.75rem;
        }

        .user-count {
            width: 25px;
            height: 25px;
            font-size: 1rem;
        }

        .availability-dots {
            gap: 0.15rem;
        }

        .user-dot {
            width: 6px;
            height: 6px;
        }

        .user-dot.overflow {
            width: 12px;
            height: 12px;
            font-size: 0.5rem;
        }
    }

    @media (max-width: 480px) {
        .hero-section {
            padding: 2rem 0 1rem;
        }

        .hero-title {
            font-size: 1.5rem;
        }

        .projects-showcase-card,
        .calendar-container-modern {
            padding: 1.5rem;
        }

        .project-showcase-item {
            padding: 1.5rem;
        }

        .teammate-card {
            flex-direction: column;
            text-align: center;
        }

        .teammate-avatar {
            align-self: center;
        }
    }

    /* Accessibility Improvements */
    @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
        }

        .hero-particle {
            animation: none;
        }

        .ring {
            animation: none;
        }
    }

    /* Print Styles */
    @media print {
        .hero-section,
        .action-section {
            display: none;
        }

        .team-availability-page {
            background: white;
        }

        .calendar-container-modern,
        .project-showcase-item,
        .teammate-card {
            box-shadow: none;
            border: 1px solid #ddd;
        }

        .table-responsive-modern {
            max-height: none;
            overflow: visible;
        }
    }

    /* Focus Styles for Accessibility */
    .toggle-btn:focus,
    .btn:focus {
        outline: 2px solid var(--primary-color);
        outline-offset: 2px;
    }

    /* High Contrast Mode Support */
    @media (prefers-contrast: high) {
        :root {
            --primary-color: #0056b3;
            --secondary-color: #007a3e;
            --text-color: #000000;
            --text-light: #333333;
        }

        .project-showcase-item,
        .teammate-card {
            border: 2px solid #000000;
        }
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // View toggle functionality - FIXED
        const toggleButtons = document.querySelectorAll('.toggle-btn');
        const calendar = document.getElementById('teamCalendar');

        toggleButtons.forEach(button => {
            button.addEventListener('click', function() {
                const view = this.dataset.view;
                
                // Remove active class from all toggle buttons
                toggleButtons.forEach(btn => btn.classList.remove('active'));
                // Add active class to clicked button
                this.classList.add('active');

                // Apply view styles by toggling classes
                if (view === 'compact') {
                    calendar.classList.remove('detailed-view');
                    calendar.classList.add('compact-view');
                } else {
                    calendar.classList.remove('compact-view');
                    calendar.classList.add('detailed-view');
                }
            });
        });

        // Enhanced tooltips for availability cells
        const availabilityCells = document.querySelectorAll('.availability-cell-modern');
        
        availabilityCells.forEach(cell => {
            cell.addEventListener('mouseenter', function() {
                const count = this.dataset.count;
                
                if (count > 0) {
                    this.style.transform = 'scale(1.05)';
                    this.style.zIndex = '15';
                }
            });

            cell.addEventListener('mouseleave', function() {
                this.style.transform = '';
                this.style.zIndex = '';
            });
        });

        // Add fade-in animation keyframes
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(10px); }
                to { opacity: 1; transform: translateY(0); }
            }
        `;
        document.head.appendChild(style);
    });
</script>
{% endblock %}